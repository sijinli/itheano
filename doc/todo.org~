* TODO divide the gradients by the number of samples

