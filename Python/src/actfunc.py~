"""
It contains the activation classes for theano variables
"""
import theano
class Activation(object):
    def __init__(self, act_params):
        pass
class Relu(Activation):
    def __init__(self, act_params=None):
        self.name = 'relu'
    @classmethod
    def __call__(self, X):
        return theano.tensor.switch(X<0,0,X)
    def __str__(self):
        return 'Rectified Linear Unit (y = x if x >= 0)'

class Relu2(Activation):
    def __init__(self, act_params=None):
        self.name = 'relu2'
    @classmethod
    def __call__(self, X):
        return theano.tensor.switch(X>0,X,0)
    def __str__(self):
        return 'Rectified Linear Unit2: when y = x if x > 0'
        
class Abs(Activation):
    def __init__(self, act_params=None):
        self.name = 'abs'
    @classmethod
    def __call__(self, X):
        return abs(X)
    def __str__(self):
        return 'Absolute Unit'
    
def make_actfunc(name, params):
    return act_dic[name](params)



act_dic = {'relu':Relu, 'relu2':Relu2, 'abs':Abs}